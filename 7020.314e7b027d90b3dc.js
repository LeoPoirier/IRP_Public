"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7020],{4449:(x,E,y)=>{function m(o){return function r(o){return new DataView(Uint8Array.from(o).buffer)}(o.trim().split(" ").filter(f=>""!==f).map(f=>parseInt(f,16)))}function c(o){return function p(o){return Array.from(new Uint8Array(o.buffer,o.byteOffset,o.byteLength))}(o).map(d=>{let f=d.toString(16);return 1==f.length&&(f="0"+f),f}).join(" ")}function O(o){if("string"==typeof o)return o;if("number"==typeof o)return function q(o){return`0000${o.toString(16).padStart(4,"0")}-0000-1000-8000-00805f9b34fb`}(o);throw new Error("Invalid UUID")}function v(o){const d={};if(o)return o.forEach((f,Z)=>{d[Z.toString()]=f}),d}y.d(E,{FF:()=>c,GA:()=>v,JA:()=>O,_j:()=>m})},7020:(x,E,y)=>{y.d(E,{x:()=>Q});var r=y(5861),p=y(7423),w=y(4449);const u=(0,p.fo)("BluetoothLe",{web:()=>y.e(2728).then(y.bind(y,2728)).then(s=>new s.BluetoothLeWeb)});function m(s){return s?(()=>{let s=Promise.resolve();return e=>new Promise((t,n)=>{s=s.then(()=>e()).then(t).catch(n)})})():e=>e()}function c(s){if("string"!=typeof s)throw new Error(`Invalid UUID type ${typeof s}. Expected string.`);if(!((s=s.toLowerCase()).search(/^[0-9a-f]{8}\b-[0-9a-f]{4}\b-[0-9a-f]{4}\b-[0-9a-f]{4}\b-[0-9a-f]{12}$/)>=0))throw new Error(`Invalid UUID format ${s}. Expected 128 bit string (e.g. "0000180d-0000-1000-8000-00805f9b34fb").`);return s}const v=new class O{constructor(){this.scanListener=null,this.eventListeners=new Map,this.queue=m(!0)}enableQueue(){this.queue=m(!0)}disableQueue(){this.queue=m(!1)}initialize(e){var t=this;return(0,r.Z)(function*(){yield t.queue((0,r.Z)(function*(){yield u.initialize(e)}))})()}isEnabled(){var e=this;return(0,r.Z)(function*(){return yield e.queue((0,r.Z)(function*(){return(yield u.isEnabled()).value}))})()}requestEnable(){var e=this;return(0,r.Z)(function*(){yield e.queue((0,r.Z)(function*(){yield u.requestEnable()}))})()}enable(){var e=this;return(0,r.Z)(function*(){yield e.queue((0,r.Z)(function*(){yield u.enable()}))})()}disable(){var e=this;return(0,r.Z)(function*(){yield e.queue((0,r.Z)(function*(){yield u.disable()}))})()}startEnabledNotifications(e){var t=this;return(0,r.Z)(function*(){yield t.queue((0,r.Z)(function*(){var n;const i="onEnabledChanged";yield null===(n=t.eventListeners.get(i))||void 0===n?void 0:n.remove();const a=yield u.addListener(i,l=>{e(l.value)});t.eventListeners.set(i,a),yield u.startEnabledNotifications()}))})()}stopEnabledNotifications(){var e=this;return(0,r.Z)(function*(){yield e.queue((0,r.Z)(function*(){var t;const n="onEnabledChanged";yield null===(t=e.eventListeners.get(n))||void 0===t?void 0:t.remove(),e.eventListeners.delete(n),yield u.stopEnabledNotifications()}))})()}isLocationEnabled(){var e=this;return(0,r.Z)(function*(){return yield e.queue((0,r.Z)(function*(){return(yield u.isLocationEnabled()).value}))})()}openLocationSettings(){var e=this;return(0,r.Z)(function*(){yield e.queue((0,r.Z)(function*(){yield u.openLocationSettings()}))})()}openBluetoothSettings(){var e=this;return(0,r.Z)(function*(){yield e.queue((0,r.Z)(function*(){yield u.openBluetoothSettings()}))})()}openAppSettings(){var e=this;return(0,r.Z)(function*(){yield e.queue((0,r.Z)(function*(){yield u.openAppSettings()}))})()}setDisplayStrings(e){var t=this;return(0,r.Z)(function*(){yield t.queue((0,r.Z)(function*(){yield u.setDisplayStrings(e)}))})()}requestDevice(e){var t=this;return(0,r.Z)(function*(){return e=e?t.validateRequestBleDeviceOptions(e):void 0,yield t.queue((0,r.Z)(function*(){return yield u.requestDevice(e)}))})()}requestLEScan(e,t){var n=this;return(0,r.Z)(function*(){e=n.validateRequestBleDeviceOptions(e),yield n.queue((0,r.Z)(function*(){var i;yield null===(i=n.scanListener)||void 0===i?void 0:i.remove(),n.scanListener=yield u.addListener("onScanResult",a=>{const l=Object.assign(Object.assign({},a),{manufacturerData:n.convertObject(a.manufacturerData),serviceData:n.convertObject(a.serviceData),rawAdvertisement:a.rawAdvertisement?n.convertValue(a.rawAdvertisement):void 0});t(l)}),yield u.requestLEScan(e)}))})()}stopLEScan(){var e=this;return(0,r.Z)(function*(){yield e.queue((0,r.Z)(function*(){var t;yield null===(t=e.scanListener)||void 0===t?void 0:t.remove(),e.scanListener=null,yield u.stopLEScan()}))})()}getDevices(e){var t=this;return(0,r.Z)(function*(){if(!Array.isArray(e))throw new Error("deviceIds must be an array");return t.queue((0,r.Z)(function*(){return(yield u.getDevices({deviceIds:e})).devices}))})()}getConnectedDevices(e){var t=this;return(0,r.Z)(function*(){if(!Array.isArray(e))throw new Error("services must be an array");return e=e.map(c),t.queue((0,r.Z)(function*(){return(yield u.getConnectedDevices({services:e})).devices}))})()}connect(e,t,n){var i=this;return(0,r.Z)(function*(){yield i.queue((0,r.Z)(function*(){var a;if(t){const l=`disconnected|${e}`;yield null===(a=i.eventListeners.get(l))||void 0===a?void 0:a.remove();const h=yield u.addListener(l,()=>{t(e)});i.eventListeners.set(l,h)}yield u.connect(Object.assign({deviceId:e},n))}))})()}createBond(e,t){var n=this;return(0,r.Z)(function*(){yield n.queue((0,r.Z)(function*(){yield u.createBond(Object.assign({deviceId:e},t))}))})()}isBonded(e){var t=this;return(0,r.Z)(function*(){return yield t.queue((0,r.Z)(function*(){return(yield u.isBonded({deviceId:e})).value}))})()}disconnect(e){var t=this;return(0,r.Z)(function*(){yield t.queue((0,r.Z)(function*(){yield u.disconnect({deviceId:e})}))})()}getServices(e){var t=this;return(0,r.Z)(function*(){return yield t.queue((0,r.Z)(function*(){return(yield u.getServices({deviceId:e})).services}))})()}discoverServices(e){var t=this;return(0,r.Z)(function*(){yield t.queue((0,r.Z)(function*(){yield u.discoverServices({deviceId:e})}))})()}getMtu(e){var t=this;return(0,r.Z)(function*(){return yield t.queue((0,r.Z)(function*(){return(yield u.getMtu({deviceId:e})).value}))})()}requestConnectionPriority(e,t){var n=this;return(0,r.Z)(function*(){yield n.queue((0,r.Z)(function*(){yield u.requestConnectionPriority({deviceId:e,connectionPriority:t})}))})()}readRssi(e){var t=this;return(0,r.Z)(function*(){return yield t.queue((0,r.Z)(function*(){const i=yield u.readRssi({deviceId:e});return parseFloat(i.value)}))})()}read(e,t,n,i){var a=this;return(0,r.Z)(function*(){return t=c(t),n=c(n),yield a.queue((0,r.Z)(function*(){const h=yield u.read(Object.assign({deviceId:e,service:t,characteristic:n},i));return a.convertValue(h.value)}))})()}write(e,t,n,i,a){var l=this;return(0,r.Z)(function*(){return t=c(t),n=c(n),l.queue((0,r.Z)(function*(){if(!i?.buffer)throw new Error("Invalid data.");let h=i;"web"!==p.dV.getPlatform()&&(h=(0,w.FF)(i)),yield u.write(Object.assign({deviceId:e,service:t,characteristic:n,value:h},a))}))})()}writeWithoutResponse(e,t,n,i,a){var l=this;return(0,r.Z)(function*(){t=c(t),n=c(n),yield l.queue((0,r.Z)(function*(){if(!i?.buffer)throw new Error("Invalid data.");let h=i;"web"!==p.dV.getPlatform()&&(h=(0,w.FF)(i)),yield u.writeWithoutResponse(Object.assign({deviceId:e,service:t,characteristic:n,value:h},a))}))})()}readDescriptor(e,t,n,i,a){var l=this;return(0,r.Z)(function*(){return t=c(t),n=c(n),i=c(i),yield l.queue((0,r.Z)(function*(){const g=yield u.readDescriptor(Object.assign({deviceId:e,service:t,characteristic:n,descriptor:i},a));return l.convertValue(g.value)}))})()}writeDescriptor(e,t,n,i,a,l){var h=this;return(0,r.Z)(function*(){return t=c(t),n=c(n),i=c(i),h.queue((0,r.Z)(function*(){if(!a?.buffer)throw new Error("Invalid data.");let g=a;"web"!==p.dV.getPlatform()&&(g=(0,w.FF)(a)),yield u.writeDescriptor(Object.assign({deviceId:e,service:t,characteristic:n,descriptor:i,value:g},l))}))})()}startNotifications(e,t,n,i){var a=this;return(0,r.Z)(function*(){t=c(t),n=c(n),yield a.queue((0,r.Z)(function*(){var l;const h=`notification|${e}|${t}|${n}`;yield null===(l=a.eventListeners.get(h))||void 0===l?void 0:l.remove();const g=yield u.addListener(h,D=>{i(a.convertValue(D?.value))});a.eventListeners.set(h,g),yield u.startNotifications({deviceId:e,service:t,characteristic:n})}))})()}stopNotifications(e,t,n){var i=this;return(0,r.Z)(function*(){t=c(t),n=c(n),yield i.queue((0,r.Z)(function*(){var a;const l=`notification|${e}|${t}|${n}`;yield null===(a=i.eventListeners.get(l))||void 0===a?void 0:a.remove(),i.eventListeners.delete(l),yield u.stopNotifications({deviceId:e,service:t,characteristic:n})}))})()}validateRequestBleDeviceOptions(e){return e.services&&(e.services=e.services.map(c)),e.optionalServices&&(e.optionalServices=e.optionalServices.map(c)),e}convertValue(e){return"string"==typeof e?(0,w._j)(e):void 0===e?new DataView(new ArrayBuffer(0)):e}convertObject(e){if(void 0===e)return;const t={};for(const n of Object.keys(e))t[n]=this.convertValue(e[n]);return t}};var o=y(5529),d=(()=>{return(s=d||(d={}))[s.Temperature=0]="Temperature",s[s.Current=1]="Current",d;var s})(),f=(()=>{return(s=f||(f={}))[s.TIDS=0]="TIDS",s[s.INA234=1]="INA234",f;var s})(),Z=(()=>{return(s=Z||(Z={}))[s.Internal=0]="Internal",s[s.External=1]="External",Z;var s})();class A{constructor(e,t){this.onDataReceived=new o.xQ,this.sensorID=e,this.sensorPosition=t}getAttributes(){return this.attributes}getAttribute(e){return this.attributes.get(e)}clearData(){this.attributes.forEach(e=>{e.clearData()}),this.updateinterval=void 0}getSensorName(){return f[this.getType()]}getSensorFunctionality(){const e=Array.from(this.getAttributes())[0][1];return d[e.getAttributeType()]}getUpdateInterval(){return this.updateinterval}getSensorPosition(){return this.sensorPosition}getSensorPositionString(){return Z[this.getSensorPosition()]}getSensorID(){return this.sensorID}parseupdateinterval(e,t){this.updateinterval=e.getInt32(t,!0)}static generateUniqueID(e,t,n){return e<<16|t<<8|n}}var S=(()=>{return(s=S||(S={}))[s.Data=0]="Data",s[s.UpdateInterval=1]="UpdateInterval",S;var s})();class C{constructor(e){this.onDataReceived=new o.xQ,this.values=[],this.parentsensor=e}getCurrentAttributeString(){return 0==this.values.length?"":this.getAttributeValueString(this.values[this.values.length-1])}getValues(){return this.values}getCurrentValue(){return 0==this.values.length?null:this.values[this.values.length-1]}getParentsensor(){return this.parentsensor}addValue(e){this.values.push(e),this.onDataReceived.next()}clearData(){this.values=[]}}class j extends C{getAttributeName(){return"Temperature"}getAttributeType(){return d.Temperature}getAttributeValueString(e){return e.getData().toFixed(2)+" \xb0C"}}class _{constructor(e,t){this.timestamp=e,this.data=t}getTimestamp(){return this.timestamp}getData(){return this.data}setData(e){this.data=e}}class k extends A{constructor(e,t){super(e,t),this.attributes=new Map([[d.Temperature,new j(this)]])}getType(){return f.TIDS}parsedata(e,t){let n=Date.now();this.getAttribute(d.Temperature).addValue(new _(n,e.getInt32(t,!0)/100)),this.onDataReceived.next()}}class F extends C{getAttributeName(){return"Current"}getAttributeType(){return d.Current}getAttributeValueString(e){return e.getData()+" mA"}}class $ extends A{constructor(e,t){super(e,t),this.attributes=new Map([[d.Current,new F(this)]])}getType(){return f.INA234}parsedata(e,t){let n=Date.now();this.getAttribute(d.Current).addValue(new _(n,e.getInt32(t,!0)/100)),this.onDataReceived.next()}}var H=y(6738);const L="6e400001-c352-11e5-953d-0002a5d5c51b",U="6e400003-c352-11e5-953d-0002a5d5c51b",I=[1,73,82,80,66,82,68];let Q=(()=>{class s{constructor(){this.sensors=new Map,this.connected=!1,this.onDataReceived=new o.xQ,this.onDeviceDisconnected=new o.xQ,this.onSensorAdded=new o.xQ,this.sensors.clear()}initializeble(){return(0,r.Z)(function*(){try{yield v.initialize({androidNeverForLocation:!0})}catch(t){console.error(t)}})()}startscan(t){return(0,r.Z)(function*(){try{yield v.requestLEScan({services:[L]},n=>{t(n)})}catch(n){console.error(n)}})()}requestdevice(t){return(0,r.Z)(function*(){try{let n=yield v.requestDevice({services:[L]});t(n)}catch{t(void 0)}})()}stopscan(){return(0,r.Z)(function*(){try{yield v.stopLEScan()}catch(t){console.error(t)}})()}checkmanufacturerdata(t){if(null!=t&&t.byteLength==I.length){for(let n=0;n<I.length;n++)if(t.getUint8(n)!=I[n])return!1;return!0}return!1}connect(t){var n=this;return(0,r.Z)(function*(){for(yield v.disconnect(t),yield v.connect(t,()=>{n.sensors.forEach(i=>{i.clearData()}),n.sensors.clear(),n.connected=!1,n.onDeviceDisconnected.next()});!n.connected;)yield v.getServices(t).then(i=>{n.connected=0!=i.length})})()}disconnect(t){var n=this;return(0,r.Z)(function*(){yield v.stopNotifications(t,L,U),yield v.disconnect(t),n.sensors.forEach(i=>{i.clearData()}),n.sensors.clear(),n.connected=!1})()}isconnected(){return this.connected}starttxnotifications(t){var n=this;return(0,r.Z)(function*(){setTimeout((0,r.Z)(function*(){yield v.startNotifications(t,L,U,i=>{n.parsedata(i),n.onDataReceived.next()})}),100)})()}parsedata(t){t.getUint8(0);for(var i=1;i<t.byteLength;){let a=t.getUint8(i+0),l=t.getUint8(i+1),h=t.getUint8(i+2),g=t.getUint8(i+3),D=t.getUint8(i+4),b=A.generateUniqueID(h,g,D);switch(l){case S.Data:this.sensors.has(b)&&this.sensors.get(b).parsedata(t,i+5);break;case S.UpdateInterval:if(!this.sensors.has(b))switch(h){case f.TIDS:this.sensors.set(b,new k(D,g)),this.onSensorAdded.next(this.sensors.get(b));break;case f.INA234:this.sensors.set(b,new $(D,g)),this.onSensorAdded.next(this.sensors.get(b));break;default:return}this.sensors.get(b).parseupdateinterval(t,i+5);break;default:return}i+=a}}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275prov=H.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})()}}]);